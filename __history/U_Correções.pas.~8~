unit U_Correções;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls;

type
  TFRM_Correcoes = class(TForm)
    GroupBox1: TGroupBox;
    CBNatReceita: TCheckBox;
    CBAliquotas: TCheckBox;
    BTNCorrecao: TButton;
    procedure BTNCorrecaoClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FRM_Correcoes: TFRM_Correcoes;

implementation

{$R *.dfm}

uses U_Principal;

procedure TFRM_Correcoes.BTNCorrecaoClick(Sender: TObject);
var
i,j,k,l :integer;
cst04_01, cst04_02: Double;
begin
 if CBNatReceita.Checked then begin


 end;
// Corrige o problema de arredondamento das aliquotas de pis e cofins.
 if CBAliquotas.Checked then begin
  with FRM_Principal.SpedPC.Bloco_C do begin
   with RegistroC001 do begin
    for i := 0 to RegistroC010.Count -1 do begin
     with RegistroC010.Items[i] do begin
      for j := 0 to RegistroC100.Count-1 do begin
       with RegistroC100.Items[j] do begin
        for k := 0 to RegistroC170.Count -1 do begin
         with RegistroC170.Items[k] do begin
          if (ALIQ_PIS_PERC = 0.2) then begin
            ALIQ_PIS_PERC := 0.1980;
            ALIQ_COFINS_PERC := 0.9120;
          end;
         end;
        end;
       end;
      end;
     end;
    end;
   end;
  end;
 end;

end;

end.
